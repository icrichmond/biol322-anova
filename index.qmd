---
title: "Analysis of variance (ANOVA designs)"
subtitle: "BIOL322 Lecture 17"
author: Isabella Richmond & Dr. Pedro Peres-Neto
date: November 10, 2022
format: 
  revealjs:
    theme: night
    incremental: true
---



## Learning Goals

- *Understand* what an ANOVA is 
- *Understand* when/how to use an ANOVA
- *Understand* what a F-statistic is and where it comes from
- *Differentiate* between statistical & research conclusions



## When do I use an ANOVA?

- You have groups! 
- We are explaining <w style = "color: #2c4b27"> *continuous* </w> dependent variables using <w style = "color: #574571"> **categorical** </w> independent variables 
  - i.e., if you want to know if there are differences between more than two <w style = "color: #574571"> groups </w>



## What is an ANOVA?

:::nonincremental
- One-way = **one**  <w style = "color: #574571"> categorical </w> explanatory variable 
- Statistical test used to compare variation across means of 2+ <w style = "color: #574571"> groups </w>

```{r, echo = F, eval = T, fig.align='center', out.width='70%'}
library(ggpubr)
d <- read.csv("presentation_imgs/chap15e1KneesWhoSayNight.csv")
ggboxplot(d, x = "treatment", y = "shift", add = "jitter", color = "treatment", palette = c("#e7ad52",  "#2c4b27", "#574571")) +
  labs(y = "", x = "") + 
  theme(legend.position = "none",
        axis.text.x = element_blank())
```

:::



## History of ANOVAs

::: {layout-ncol=2}
- Invented by Sir R.A. Fisher ("father of modern statistics")
- Used to prove differences between groups to support eugenics (among other things)

![](presentation_imgs/fisher.JPG)
:::

::: aside
[Wikipedia](https://en.wikipedia.org/wiki/Ronald_Fisher)
:::



## Example - knees are the new eyeballs??

Background: photoreceptor cells influence our circadian rhythm based on how much light they receive & when

- mammals thought to only have these cells in our eyeballs   
- did experiment to test if these cells are present behind the knees ([Campbell & Murphy, 1998](https://www.science.org/doi/10.1126/science.279.5349.396))
- 33 trials of 2 groups: control or experimental (knee)
- found evidence light exposure to knees can change circadian rhythm! But...



## Example - knees are the new eyeballs??

:::: {.columns}

::: {.column}
![Figure 1. Phase Delay](presentation_imgs/phasedelay.jpeg){width='60%'}
:::

::: {.column}
![Figure 2. Phase Advance](presentation_imgs/phaseadvance.jpeg){width='60%'}
:::
::::



## Example - knees are not the new eyeballs! 
- one huge problem in the study highlighted in a rebuttal paper ([Wright Jr. & Czeisler 2002](https://www.science.org/doi/10.1126/science.1071697))
- initial study did not cover patients eyes during the experiment! 
- new study with 3 groups: control, light exposure with blindfold (knee), light exposure without blindfold (eyes)
- no effect of light exposure to knees
- perfect case for an ANOVA! 



## Example - knees are not the new eyeballs! 

```{r, echo = F, eval = T, fig.align='center'}
library(ggpubr)
d <- read.csv("presentation_imgs/chap15e1KneesWhoSayNight.csv")
ggboxplot(d, x = "treatment", y = "shift", add = "jitter", color = "treatment", palette = c("#e7ad52",  "#2c4b27", "#574571")) +
  labs(y = "Change in Melatonin Phase", x = "Treatment Group") + 
  theme(legend.position='none')
```



## BREAK 
::: nonincremental
- 2 minute brain break! 
:::



## Statistical Hypothesis Testing

Null hypothesis & alternative hypothesis framework:  

- H~0~ = there is no *statistical* significance between the groups 
- H~A~ = there is a *statistical* significance between the groups 
- we either: 
  a) reject the null hypothesis 
  b) fail to reject the null hypothesis (**!= accept**)
- statistical significance != biological significance 



## The Sensitivity of the F-Statistic
::: nonincremental
- The F-statistic penalizes for variance **within groups**
  - as variance **within groups** increases, F-statistic decreases even when the **between group** variance is the same

```{r, echo = F, eval = T, fig.align='center', out.width='60%'}
library(reshape2)
library(ggplot2)
dat1 <- read.table(text = "info mean sd
group1 10 1
group2 20 1
", header = TRUE)

densities <- apply(dat1[, -1], 1, function(x) rnorm(n = 1000, mean = x[1], sd = x[2]))

colnames(densities) <- dat1$info

#Put into long format
densities.m <- melt(densities)

#Plot
ggplot(densities.m, aes(value, linetype = Var2)) + 
  geom_density() +
  theme_classic() + 
  labs(x = "", y = "") + 
  theme(legend.position = 'none')

```
:::


## One-Way ANOVAs

- one-way ANOVAs test if there is a statistically significant difference between the means of 2+ groups using the F-statistic 
- the more different the groups are, the more likely we are to **reject the null hypothesis** and determine them as significantly different

```{r, echo = F, eval = T}




```


## The Sensitivity of the F-Statistic

:::nonincremental
- these groups have a lower F-statistic (and therefore are less likely to be statistically significant), even though they have the same means (**between group variance**) as the last slide
  - they just have more **within group** variance
  
```{r, echo = F, eval = T, fig.align='center', out.width='60%'}
library(reshape2)
library(ggplot2)
dat2 <- read.table(text = "info mean sd
group1 10 5
group2 20 5
", header = TRUE)

densities <- apply(dat2[, -1], 1, function(x) rnorm(n = 1000, mean = x[1], sd = x[2]))

colnames(densities) <- dat2$info

#Put into long format
densities.m <- melt(densities)

#Plot
ggplot(densities.m, aes(value, linetype = Var2)) + 
  geom_density() +
  theme_classic() + 
  labs(x = "", y = "") + 
  theme(legend.position = 'none')

```
:::



## Analysis of Variance (AMONG MEANS)
- ANOVAs are only variance among **means**, not variance in general







## Part VII: F-Statistic Workthrough 
- why is penalization important
- makes sampling error important



## BREAK

:::nonincremental 
- 2 min brain break
:::



## Part VIII: What des data look like in R?


## Part IX: ANOVA code 
- use aov not lm


## Part X: t2 = F for two groups 
- make demonstration via code
- or t = sqrt(F)


## Part XI: Statistical Conclusion of Example


## Part XII: Reporting of ANOVA Tables

** NO ACCEPTING HO** 


## Part XIII: How was F Distribution Built from ANOVA perspective?
- diagram


## Part XIV: ANOVA R output


## Part XV: Automatically one-tailed test bc F is squared


## Part XVI: Statistical Hypothesis Testing -> Research Conclusion


## Part XVII: ANOVA Assumptions

